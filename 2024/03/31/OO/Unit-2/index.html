<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Squirrel7ang">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://squirrel7ang.github.io/2024/03/31/oo/unit-2/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="电梯能随意踢人？？？">
<meta property="og:type" content="article">
<meta property="og:title" content="「BUAA OO」Unit-2 电梯调度">
<meta property="og:url" content="https://squirrel7ang.github.io/2024/03/31/OO/Unit-2/index.html">
<meta property="og:site_name" content="Squirrel7ang Blog">
<meta property="og:description" content="电梯能随意踢人？？？">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw5_coouml.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw5_uml.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw5_method.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw5_class.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw6_coouml.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw6_method.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw6_class.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw7_coouml.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw7_uml.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw7_method.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/hw7_class.png">
<meta property="og:image" content="https://squirrel7ang.github.io/images/OO/U2/ElevatorThreadComplexity.png">
<meta property="article:published_time" content="2024-03-31T10:55:00.000Z">
<meta property="article:modified_time" content="2024-04-19T07:30:05.170Z">
<meta property="article:author" content="Squirrel7ang">
<meta property="article:tag" content="OO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://squirrel7ang.github.io/images/OO/U2/hw5_coouml.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            「BUAA OO」Unit-2 电梯调度 -
        
        Squirrel7ang&#39;s Blog
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    
        <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    
<script src="/js/libs/anime.min.js"></script>

    <h1 class="ml13">
        Squirrel7ang&#39;s Blog
    </h1>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });


        anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [100,0],
                translateZ: 0,
                opacity: [0,1],
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i
            }).add({
            targets: '.ml13 .letter',
            translateY: [0,-100],
            opacity: [1,0],
            easing: "easeInExpo",
            duration: 1200,
            delay: (el, i) => 100 + 30 * i
        });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            hidePreloaderAfterTimeout(1000); // Hide after 1000 milliseconds once the window has loaded
        });

        // Backup failsafe: Hide preloader after a maximum of 5000 milliseconds, regardless of the window load event
        hidePreloaderAfterTimeout(5000);

        function hidePreloaderAfterTimeout(delay) {
            setTimeout(function () {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function () {
                    preloader.style.display = 'none';
                }, 200);
            }, delay);
        }
    </script>
</div>
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"squirrel7ang.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left"},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-yxgmll-light.png","dark":"/images/wallhaven-l8kmop-dark.png"},"title":"Squirrel7ang's Blog","subtitle":{"text":["BUAA-CO-2023-Aut","BUAA-OO-2024-Spr","BUAA-OS-2024-Spr","And More~"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.6.0","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"More":{"icon":"fa-regular fa-ellipsis-stroke","submenus":{"categories":"/categories","tags":"/tags"}},"CO":{"path":"/categories/CO","icon":"fa-solid fa-microchip"},"OO":{"path":"/categories/OO","icon":"fa-brands fa-java"},"Github":{"icon":"fa-brands fa-github","submenus":{"CO":"https://github.com/Squirrel7ang/BUAA-CO-2023-Aut"}},"OS":{"path":"/categories/OS","icon":"fa-brands fa-linux"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"https://squirrel7ang.github.io/2023/12/31/about/me/","Github":"https://github.com/Squirrel7ang"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"cloud"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"archives":{"path":"/archives","icon":"fa-regular fa-archive"},"tags":{"path":"/tags","icon":"fa-regular fa-tags"},"categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":4}},"footerStart":"2023/12/31 19:56:36"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.0.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">

    <div class="navbar-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/avatar.jpg">
                </a>
            
            <a class="logo-title" href="/">
                
                Squirrel7ang&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-ellipsis-stroke fa-fw"></i>
                                    更多
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/categories">
                                                    分类
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/tags">
                                                    标签
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/CO"
                                        >
                                    <i class="fa-solid fa-microchip fa-fw"></i>
                                    CO
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/OO"
                                        >
                                    <i class="fa-brands fa-java fa-fw"></i>
                                    OO
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-brands fa-github fa-fw"></i>
                                    GITHUB
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/Squirrel7ang/BUAA-CO-2023-Aut">
                                                    CO
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/OS"
                                        >
                                    <i class="fa-brands fa-linux fa-fw"></i>
                                    OS
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    关于
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="https://squirrel7ang.github.io/2023/12/31/about/me/">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/Squirrel7ang">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-More"
                        >
                            <span>
                                更多
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-More">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/categories">分类</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/tags">标签</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/CO"
                        >
                            <span>
                                CO
                            </span>
                            
                                <i class="fa-solid fa-microchip fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/OO"
                        >
                            <span>
                                OO
                            </span>
                            
                                <i class="fa-brands fa-java fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-Github"
                        >
                            <span>
                                GITHUB
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-Github">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/Squirrel7ang/BUAA-CO-2023-Aut">CO</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/OS"
                        >
                            <span>
                                OS
                            </span>
                            
                                <i class="fa-brands fa-linux fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                关于
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="https://squirrel7ang.github.io/2023/12/31/about/me/">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/Squirrel7ang">GITHUB</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">10</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">14</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                
                
                <img src="https://squirrel7ang.github.io/images/cover/cover_14.png" alt="「BUAA OO」Unit-2 电梯调度" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75"/>
                
                <div class="w-full flex items-center absolute bottom-0 justify-start">
                    <h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-bold backdrop-blur-lg rounded-xl border border-border-color ">「BUAA OO」Unit-2 电梯调度</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/avatar.jpg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Squirrel7ang</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv2</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-03-31 18:55</span>
        <span class="mobile">2024-03-31 18:55</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-04-19 15:30:05</span>
            <span class="mobile">2024-04-19 15:30:05</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/OO/">OO</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/OO/">OO</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h1 id="电梯"><a href="#电梯" class="headerlink" title="电梯"></a>电梯</h1><h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>考虑到第一次博客写的实在是太复杂，第六次作业的博客我希望能够按照更加清晰的结构来叙述我的设计。在这次博客中，我将解题思路单独叙述，再进一步叙述我的设计架构。</p>
<h2 id="二、题目背景"><a href="#二、题目背景" class="headerlink" title="二、题目背景"></a>二、题目背景</h2><p>重述题目，熟悉题目的话可以跳过这一部分。</p>
<h3 id="第五次作业"><a href="#第五次作业" class="headerlink" title="第五次作业"></a>第五次作业</h3><h4 id="1-题目背景"><a href="#1-题目背景" class="headerlink" title="1. 题目背景"></a>1. 题目背景</h4><ol>
<li>六部电梯</li>
<li>每部电梯单独工作</li>
<li>每个人只能等它指定的一部电梯</li>
<li>每部电梯最多承载六个人</li>
<li>每部电梯在一楼和十一楼往返运行</li>
<li>根据题意，每部电梯需要在每一层楼都能停留，即不能出现高低层电梯和奇偶层电梯这类电梯</li>
<li>每次上下一层楼花费0.4秒</li>
<li>开关门各0.2秒，从门开始打开到完全关闭期间，乘客可以随意进出</li>
<li>电梯没有加速度，纸片人不会被门夹</li>
<li>电梯就是神，只要愿意就可以随意吃人吐人</li>
<li>人可能在任意时间在任意楼层按电梯（具体什么时候在哪层楼取决于输入）</li>
<li>输入不能使得初始楼层和目标楼层相等</li>
</ol>
<h4 id="2-评价标准"><a href="#2-评价标准" class="headerlink" title="2. 评价标准"></a>2. 评价标准</h4><p>课程组提供了两个标准。一个是正确性评判标准，一个是性能评判标准</p>
<h5 id="正确性评判"><a href="#正确性评判" class="headerlink" title="正确性评判"></a>正确性评判</h5><ol>
<li>每个人最后都必须到达目标楼层。</li>
<li>电梯最多搭载6人。</li>
<li>电梯不能飞速运行，比如电梯不能在小于0.4秒的时间内移动一层楼。</li>
<li>电梯总运行时间不能比课程组的标准运行时间（<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="3.669ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 1621.6 834.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></g></g></svg></mjx-container>）长太久。具体来说，不能比 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="28.158ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 12445.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1979,0)"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2232.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(3233,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(4233,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(4622,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(5066.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(5455.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(778,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1278,0)"></path></g><g data-mml-node="mo" transform="translate(7455.9,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msub" transform="translate(8456.1,0)"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(469,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mi" transform="translate(830,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g><g data-mml-node="mo" transform="translate(10077.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></svg></mjx-container> 长（单位：秒）</li>
<li>关门后才能开门，开门后才能关门。</li>
<li>符合客观事实，比如不能开着门上下移动，不能让人不乘电梯瞬移到目标楼层之类的。具体要求见指导书。</li>
</ol>
<h5 id="性能评判"><a href="#性能评判" class="headerlink" title="性能评判"></a>性能评判</h5><p>课程组提供了较为复杂的评估标准，不太容易懂。简单来说就是满足以下几点要求：</p>
<ol>
<li>不要让系统运行影响电梯运行时间。（系统要快）</li>
<li>不要让一个人等太久。（等待时间只按电梯到抵达目标楼层的时间）（乘客要爽）</li>
<li>不要让电梯无效运行。（电费要少）</li>
</ol>
<h3 id="第六次作业"><a href="#第六次作业" class="headerlink" title="第六次作业"></a>第六次作业</h3><h4 id="1-题目背景-1"><a href="#1-题目背景-1" class="headerlink" title="1. 题目背景"></a>1. 题目背景</h4><p>只叙述有改动的地方：</p>
<ol>
<li>每个人不再制定电梯。</li>
<li>每个人可以被调度器分配到任何一个电梯，分配后除非重置，否则不可更改。</li>
<li>电梯在把分配到自己的乘客全部运送完之后，除非有新的乘客再被分配进来，否则不应该再移动（移动会判错）。</li>
<li>乘客在被分配到电梯后应该输出<code>RECEIVE</code>语句，也就是要输出一些东西表明乘客分配到了这部电梯。</li>
<li>电梯支持<code>RESET</code>命令，<code>RESET</code>通过标准输入输入进来，电梯必须在5s内响应<code>RESET</code>请求，并且在这5s中最多移动两层楼（输出两次<code>ARRIVE</code>）。响应<code>RESET</code>请求的标志为输出<code>RESET_BEGIN</code>语句。</li>
<li><code>RESET</code>需要1.2s完成，并在完成时输出<code>RESET_END</code>语句表明<code>RESET</code>完成。</li>
<li><code>RESET</code>是用于设置电梯的新的运行状态的，这包括移动一层楼的速度和满载人数。</li>
<li><code>RESET</code>期间电梯里不能有人（可能需要踢人），<code>RESET</code>要在关门时才能<code>RESET</code>。</li>
<li><code>RESET</code>期间电梯不能接受新乘客。</li>
<li>先前被电梯接到的人在该电梯<code>RESET</code>后需要重新<code>RECEIVE</code>，当然这也意味着电梯<code>RESET</code>后可以原本的乘客可以不再坐这部电梯。</li>
</ol>
<h4 id="2-评价标准-1"><a href="#2-评价标准-1" class="headerlink" title="2. 评价标准"></a>2. 评价标准</h4><p>和上次作业几乎完全相同。</p>
<h3 id="第七次作业"><a href="#第七次作业" class="headerlink" title="第七次作业"></a>第七次作业</h3><h4 id="1-题目背景-2"><a href="#1-题目背景-2" class="headerlink" title="1. 题目背景"></a>1. 题目背景</h4><p>只叙述有改动的地方：</p>
<ol>
<li>增加双轿厢电梯。电梯初始默认单轿厢电梯，接受第二类<code>RESET</code>后转变为双轿厢电梯。</li>
<li>增加第二类<code>RESET</code>请求，用于将电梯重置为双轿厢电梯，<code>RESET</code>用时1.2s。相当于把单轿厢拆掉新建了一个双轿厢电梯。第二类<code>RESET</code>请求包括双轿厢电梯的换乘楼层、移动速度、最大人数等。</li>
<li>双轿厢在没有收到<code>RECEIVE</code>请求时仍然可以移动。</li>
<li>双轿厢分为下层轿厢<code>轿厢A</code>和上层轿厢<code>轿厢B</code>，<code>轿厢A</code>只能在换乘楼层及其下方楼层移动，<code>轿厢B</code>只能在换乘楼层及其上方楼层移动。</li>
<li>电梯在重置为双轿厢电梯后，<code>轿厢A</code>默认在换乘楼层的下面一层，<code>轿厢B</code>默认在换乘楼层的上面一层，</li>
<li>双轿厢电梯不接受<code>RESET</code>。输入保证不会出现这种情况。</li>
<li>显然，双轿厢电梯不能Crush。换乘楼层同时只能有一部电梯。</li>
<li>乘客只要离开轿厢（输出<code>OUT</code>）就需要重新<code>RECEIVE</code>。</li>
</ol>
<h4 id="2-评价标准-2"><a href="#2-评价标准-2" class="headerlink" title="2. 评价标准"></a>2. 评价标准</h4><ol>
<li>双轿厢电梯的耗电量是正常电梯的1/4。这无疑增加了影子电梯的编写难度。</li>
</ol>
<h2 id="三、解题思路"><a href="#三、解题思路" class="headerlink" title="三、解题思路"></a>三、解题思路</h2><p>具体的代码设计架构在第四部分。不想看解题思路的可以跳过。</p>
<h3 id="第五次作业-1"><a href="#第五次作业-1" class="headerlink" title="第五次作业"></a>第五次作业</h3><h4 id="1-我们有哪些需求？"><a href="#1-我们有哪些需求？" class="headerlink" title="1. 我们有哪些需求？"></a>1. 我们有哪些需求？</h4><p>纵观题目，我们可以得出一个简单的结构设计：</p>
<ol>
<li>对于人来说：输入→分配到电梯→等电梯→搭电梯→出来</li>
<li>对于电梯来说：读等待的人→决定要不要接他→接/不接→送客</li>
</ol>
<p>所以基本上，我们需要有这么几个类：</p>
<ol>
<li><code>InputThread</code> 输入线程 - 采购</li>
<li><code>Schedule</code> 分配线程 - 把人分给电梯吃</li>
<li><code>Elevator</code> 电梯线程 - 吃人吐人</li>
<li><code>Client</code> 顾客类 - 人<br>然后，我们接着模块化，简化对象但是增加对象数量：</li>
<li><code>RequestQueue</code> 请求队列 - 采购但是没有被分配的人</li>
<li><code>WaitQueue</code> 等待队列 - 分配但是没有被电梯吃掉的人</li>
<li><code>Strategies</code> 策略类 - 决定电梯先吃哪个人<br>剩余的类不起到决定性效果，只是起了一点辅助作用，在此不在列举。</li>
</ol>
<h4 id="2-我们需要哪些线程？"><a href="#2-我们需要哪些线程？" class="headerlink" title="2. 我们需要哪些线程？"></a>2. 我们需要哪些线程？</h4><p>先理一理要求和思路：</p>
<ol>
<li>首先毫无疑问，我们需要<strong>1个输入线程</strong>。</li>
<li>六部电梯需要单独运行，因此需要一个<strong>6个电梯运行线程</strong>。</li>
<li>但是考虑到之后的作业，我们应该需要一个调度器，用于将乘客分配给不同的电梯。因此我们可以再新建<strong>1个调度器线程</strong>。</li>
<li>我们希望电梯开关门期间可以进入新乘客，而不是<code>sleep(200)</code>休眠200毫秒。考虑到休眠期间电梯是不会进行输入的，我们可以再新建<strong>6个电梯管理线程</strong>。</li>
<li>经过实践，我发现第四点思考难以实现也并不必要。直接删掉。</li>
<li>总结一下，<strong>1个输入，1个调度，6个电梯</strong>。</li>
</ol>
<h4 id="3-线程与线程之间的关系如何（生产-消费模式）？"><a href="#3-线程与线程之间的关系如何（生产-消费模式）？" class="headerlink" title="3. 线程与线程之间的关系如何（生产-消费模式）？"></a>3. 线程与线程之间的关系如何（生产-消费模式）？</h4><p>这是一个很奇怪的问题，在吃了苦头之前我甚至都没有问过自己这个问题。</p>
<p>电梯单元采用的多线程设计模式比较简单，即生产-消费模式。在我的设计中，生产消费关系有俩：输入和调度、调度和电梯。</p>
<h6 id="1-输入线程和调度线程"><a href="#1-输入线程和调度线程" class="headerlink" title="(1) 输入线程和调度线程"></a>(1) 输入线程和调度线程</h6><p>输入进来的乘客需要交给调度线程，由调度线程经过合适的调度策略（在这次作业中，调度策略就是把乘客调度到它指定的电梯）交给电梯。因此输入和调度线程构成生产-消费关系：输入不断生产客户，调度器不断消费客户。而存放生产出来的产品的地方正是<code>RequestQueue</code>类。</p>
<h6 id="2-调度线程和电梯线程"><a href="#2-调度线程和电梯线程" class="headerlink" title="(2) 调度线程和电梯线程"></a>(2) 调度线程和电梯线程</h6><p>调度器会将自己得到的客户交给电梯，由电梯进行消费。从输入进来的顾客会在输出后被释放，因此到这里为止搭乘电梯的顾客构成的供应链就到达链的末尾了。存放生产出来的客户的是我们的<code>WaitQueue</code>类，也就是在指定电梯面前等待的客户构成的集合。这样的集合一共有六个，每个电梯各一个。</p>
<h4 id="4-什么是锁？什么是同步方法？"><a href="#4-什么是锁？什么是同步方法？" class="headerlink" title="4. 什么是锁？什么是同步方法？"></a>4. 什么是锁？什么是同步方法？</h4><p>写这个板块纯粹是因为我在<code>synchronized</code>方法上吃了苦头。总结起来我最开始不理解的地方大概就只有这么几点：</p>
<ol>
<li>每一个<code>synchronized</code>部分一次只能由一个获得了指定锁的线程运行。这种指定的锁只有一把，当这个线程在运行的时候它就占有了锁，其他线程必定就没有占有锁，因此其他线程必定无法运行。</li>
<li>每一个<code>synchronized</code>锁就是一个对象。同步方法的锁就是这个同步方法所处的对象本身。静态同步方法锁的是类对象本身，简单理解就是这整个类的所有静态同步方法共同竞争的一把锁，它不会影响非静态同步方法。</li>
<li><strong>没事别吃饱了撑的把所有方法都锁上。</strong> 只有线程与线程产生竞争的部分需要上锁。竞争的部分是设计决定的，适当地将方法设置为private方法或许是一个好的选择。</li>
<li>原则上同步方法都应该在交出锁之前<code>notify</code>，<strong>但是有一个情况例外</strong>：就是这个同步方法是被另一个同步方法调用的。这时这个同步方法哪怕结束了，锁也不会被释放。这时不需要<code>notify</code>，否则就轮询了。</li>
<li><strong>同一对象的同步方法调用该对象的同步方法是不会死锁的。</strong> 运行父方法就会得到这个对象的锁，而在调用叶方法的时候父方法会发现已经有锁了，于是大胆进入叶方法里头。</li>
<li><strong>在生产-消费模型中，基本上只有涉及到共享数据对象的时候才会出现同步方法。</strong> 其他时候不怎么使用也不需要过多担心，否则可能就要狠狠担心一下了。</li>
</ol>
<h4 id="5-电梯运行策略"><a href="#5-电梯运行策略" class="headerlink" title="5. 电梯运行策略"></a>5. 电梯运行策略</h4><p>详细见第五部分“五、调度策略选择”</p>
<h3 id="第六次作业-1"><a href="#第六次作业-1" class="headerlink" title="第六次作业"></a>第六次作业</h3><h4 id="1-有哪些改动？"><a href="#1-有哪些改动？" class="headerlink" title="1. 有哪些改动？"></a>1. 有哪些改动？</h4><p>第六次作业的主要改动有两个方面：一个是<code>RESET</code>，一个是乘客不知道进哪个电梯，需要调度器去调度乘客。</p>
<p>我们来分析一下我们现在的线程情况。</p>
<p>首先，一个输入线程，一个调度器线程，六个电梯线程，这八个线程应该是没得跑了。六个电梯显示关系实在是太复杂了，我们先考虑一个电梯，也就是先考虑3个线程先。（直觉告诉我们，六个电梯彼此应该没有太多的关系。）</p>
<pre class="mermaid">graph TD
in(输入)
sch(调度器)
ele(电梯)</pre>

<p>然后检查一下这三个线程的关系：</p>
<pre class="mermaid">graph LR
in(输入)
sch(调度器)
ele(电梯)
wq(等待队列)
rq(请求/输入队列)
rs(重置信号队列)

in --&gt; rq --&gt; sch
in --&gt; rs --&gt; ele
sch --&gt; wq --&gt; ele
ele --&gt; rq</pre>

<p>其中，箭头表示生产-消费传递链。然后可以分离出电梯这个模块：</p>
<div class="highlight-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	                                +------------------+</span><br><span class="line">									|   **Elevator**   |</span><br><span class="line">									+------------------+</span><br><span class="line">   +--------------------------------|--&gt; ResetQueue    |</span><br><span class="line">   |                                |                  |</span><br><span class="line">Input            +--&gt; Scheduler ----|--&gt; WaitQueue     |</span><br><span class="line">   |             |                  |                  |</span><br><span class="line">   +--&gt; RequestQueue &lt;--------------|--- KickOut       |</span><br><span class="line">                                    +------------------+</span><br></pre></td></tr></table></figure></div>

<h4 id="2-线程终止条件"><a href="#2-线程终止条件" class="headerlink" title="2. 线程终止条件"></a>2. 线程终止条件</h4><p>和第五次作业不同，第六次作业中电梯不再只是消费者：被电梯踢出来的乘客会重新进入调度器接受调度，因此电梯在某种意义上也是生产者。</p>
<p><strong>生产和消费构成的闭环会导致一个问题：电梯和调度器线程根本停不下来！</strong> 调度器需要查看<code>RequestQueue</code>判断是否停止：如果<code>RequestQueue</code>为空并且结束了就把电梯也停下来。<code>RequestQueue</code>的结束是依赖于电梯线程的，电梯线程只要不停，<code>RequestQueue</code>就停不下来，调度器也停不下来，进而电梯也停不下来，使得程序无法结束运行。</p>
<p>为什么会出现这种情况呢？因为在闭环中只查看线程之间存放乘客的共享对象，是无法给生产消费链画上终止符号的。我们需要更多信息。对于调度器线程来说，它不仅仅需要知道共享对象的状态，还需要知道电梯线程的状态才行。再调度器得知输入线程结束了之后，调度器线程还需要确认电梯将所有的乘客都送完了才行。</p>
<p><strong>所以解决方案很简单：调度器如果发现输入线程结束了，并且没有人需要调度，并且每个电梯都没有人了，就让所有电梯都停下来，并且自己结束运行。</strong></p>
<h4 id="3-调度器调度策略"><a href="#3-调度器调度策略" class="headerlink" title="3. 调度器调度策略"></a>3. 调度器调度策略</h4><p>详细见第五部分“五、调度策略选择”</p>
<h3 id="第七次作业-1"><a href="#第七次作业-1" class="headerlink" title="第七次作业"></a>第七次作业</h3><h4 id="1-有哪些改动"><a href="#1-有哪些改动" class="headerlink" title="1. 有哪些改动"></a>1. 有哪些改动</h4><p>第七次作业是最后一次重构的机会了！我把握住了，然后写了一tuo…</p>
<p>个人认为第七次作业可能会遇到这些问题：</p>
<ol>
<li>双轿厢电梯和单轿厢电梯一共有三个线程，但是不会同时启用。那么应该由谁来管理这些线程？</li>
<li>如何处理双轿厢电梯在换乘楼层的冲突？</li>
<li>设计单双轿厢电梯，线程之间如何交互？</li>
</ol>
<h4 id="2-谁来管理电梯线程"><a href="#2-谁来管理电梯线程" class="headerlink" title="2. 谁来管理电梯线程"></a>2. 谁来管理电梯线程</h4><p>第七次作业中的电梯线程的管理其实很简单：创建单轿厢电梯、销毁单轿厢电梯、创建双轿厢电梯。所以主要矛盾集中在单双轿厢电梯的切换上。很难让单轿厢电梯创建双轿厢电梯（因为逻辑上很奇怪）所以强烈建议<strong>加入一个中间层来管理所有电梯线程</strong> （<strong>比如<code>H Boy</code>提出的创建电梯井</strong> ） 。线程的创建和销毁都是调用中间层的方法来完成的。</p>
<p>吴老师在第八次课提到了线程池，但是我没有使用过，并不清楚。</p>
<h4 id="3-如何处理双轿厢电梯在换乘楼层的冲突？"><a href="#3-如何处理双轿厢电梯在换乘楼层的冲突？" class="headerlink" title="3. 如何处理双轿厢电梯在换乘楼层的冲突？"></a>3. 如何处理双轿厢电梯在换乘楼层的冲突？</h4><p>换乘楼层就是临界区，临界区应当配备一把锁。进入临界区就要获得锁，否则等待。离开临界区就释放锁。</p>
<h4 id="4-单双轿厢设计如何"><a href="#4-单双轿厢设计如何" class="headerlink" title="4. 单双轿厢设计如何"></a>4. 单双轿厢设计如何</h4><p>见第四部分“四、架构设计和分析 - 第三次作业”。</p>
<h2 id="四、架构设计和分析"><a href="#四、架构设计和分析" class="headerlink" title="四、架构设计和分析"></a>四、架构设计和分析</h2><p>这是代码架构分析，不包含任何解题思路。解题思路请看第三部分“三、解题思路”</p>
<h3 id="第五次作业-2"><a href="#第五次作业-2" class="headerlink" title="第五次作业"></a>第五次作业</h3><h4 id="架构设计"><a href="#架构设计" class="headerlink" title="架构设计"></a>架构设计</h4><p>第五次架构设计比较简单，实现的功能也比较简单。整体设计从UML协作图中基本可以看的清清楚楚，个人认为没有太多地方需要特别叙述。解题思路</p>
<h5 id="UML协作图"><a href="#UML协作图" class="headerlink" title="UML协作图"></a>UML协作图</h5><p>在网上搜了一圈，感觉协作图（通信图）五花八门。有利用时序图来画协作图的，有我下面这样的，有利用方块表示类的。我认为只要能够说清楚线程之间的写作关系就行，因此我打算在三次作业的协作图中使用下图的形式。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw5_coouml.png" alt="hw5_coouml"></p>
<p>整体上就是一个生产消费模型，输(gong)入(chang)线程生产乘客，交给调(tao)度(bao)平台调度，最后交(mai)给电梯消费掉。</p>
<h5 id="UML类图"><a href="#UML类图" class="headerlink" title="UML类图"></a>UML类图</h5><p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw5_uml.png" alt="hw5_uml"></p>
<h4 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h4><p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw5_method.png" alt="hw5_method"></p>
<p>所有圈复杂度较高的方法我都看了一圈，事实就是<strong>if-else及其嵌套太多</strong>，用于各种条件判断。每一个if-else里面的内容就两行：一行设置下一个状态，一行return。我当然可以拆开这些if-else，然后把每一次嵌套都封装成一个私有方法，但是我并不认为这会让可读性变高，反而可能会过度封装。此外可以发现，<strong>复杂度过高的方法其实都被私有化了</strong>。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw5_class.png" alt="hw5_class"></p>
<p>我承认Strategies类写的确实不太好，不过我已经不知道怎么优化了。至于Elevator类和WaitQueue类我倒是不是很担心，我在写一个类的时候会根据外界需求在里面封装好许多好用的方法，哪怕这些方法可能并不会用到，就有点像自己搓一个小的库一样吧。这使得方法复杂度很高，但是实际上既不影响可读性，我也不认为与封装的思想相矛盾。在之后的作业中我沿用了这个类，导致复杂度一直降不下来。</p>
<p>另一方面，<strong>由于我设置了UP和DOWN两个状态，导致几乎所有和上与下有关的代码都会高度相似、对称</strong>。后面我了解到原来枚举类型也是可以设置方法的，这样子我或许可以将这部分代码简化不少。</p>
<h3 id="第六次作业-2"><a href="#第六次作业-2" class="headerlink" title="第六次作业"></a>第六次作业</h3><p>整体上分了三类线程类和三类共享对象，具体如下图所示。个人认为整体还是比较清晰的。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw6_coouml.png" alt="hw6_coouml"></p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw6_method.png" alt="hw6_method"></p>
<p>仍然是策略类的方法复杂度过高，过高原因同第五次作业相同：单纯因为需要很多的条件判断。但是整体上可读性还是蛮高的：各种<code>if-else</code>判断整体来说看得还是比较清楚的。</p>
<p>其次复杂的事<code>Elevator</code>类中的<code>actWait()</code>和<code>run()</code>方法。<code>actWait()</code>由于设计遗留的历史原因，他和<code>run()</code>方法其实有一部分代码高度相似。<strong>当时在写的时候想了半天没有想明白应该怎么设计多线程的终止条件，于是写了一个很复杂的终止条件判断</strong>，最后结果是放在<code>Elevator.run()</code>也觉得怪，放在<code>actWait()</code>中也觉得怪，所以就把两边的代码都保留了。实际上终止条件并没有这么复杂，不过我在写完第三次作业之前都不知道要怎么设计，算是一个小遗憾吧。</p>
<p><code>SchStrategy</code> 的 <code>onTheWay()</code> 方法由于时间问题，虽然写了但是没有启用，姑且不认为它复杂。<code>TestMain</code>是用于测试的代码，未提交至平台上。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw6_class.png" alt="hw6_class"></p>
<p><code>WaitQueue</code>的复杂度来源于各种不同限制条件下的查询和检索：查询高于某一楼层的希望向上走的乘客、查询该层楼下所有向下的乘客等等。每个方法并不复杂，但是由于方法实在太多，复杂度不得不上来。</p>
<p><code>Elevator</code>类的主要复杂度就是上面提到的几个复杂度较高的方法。删去后方法复杂度马上降下来了。</p>
<p><code>EleStrategy</code>的方法复杂度和第五次作业的<code>Strategies</code>复杂度完全一致，不过多叙述。</p>
<h3 id="第七次作业-2"><a href="#第七次作业-2" class="headerlink" title="第七次作业"></a>第七次作业</h3><p>第七次作业的主要改动在于封装了电梯。</p>
<p>在第五次和第六次作业中我一直是让线程对象<strong>直接调用共享对象中的方法</strong>来完成添加乘客，删除乘客等操作。但是后面发现似乎并不一定需要直接调用共享对象的方法，而<strong>可以将共享对象封装到其他对象中</strong>，调用其他对象的方法来完成。</p>
<p>比方说，如果调度器要将乘客加入到电梯中，我们会说：“把这个家伙分配给这个电梯！”而不会说：“把这个乘客放到这个电梯的等待队列中。”对于调度器来说，前者的思想更符合我个人的直觉。</p>
<p>这有什么区别呢？前者我们将电梯的等待队列的概念隐藏了，<strong>电梯对于外界而言没有等待队列的概念，外界只知道自己将一个乘客分配给了这个电梯</strong>。但是后者却将电梯的等待队列暴露了出来。</p>
<p>直接上协作图吧。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw7_coouml.png" alt="hw7_coouml"></p>
<p>关系个人认为还是很清晰的。主要是添加<code>TrashCarrier</code>现成将电梯完全封装了起来后结构变得十分清晰。</p>
<p>类图则稍微复杂了一点。我删除了所有私有化方法（继承接口是一点不会啊）</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw7_uml.png" alt="hw7_uml"></p>
<p>从中可以看出虽然加入了<code>Elevator</code>中间层，但是这没有降低多少设计复杂度。单轿厢类、电梯线程类和电梯中间层类应该有更清晰的层次关系，但是当时设计没有想太多，于是就写成这样了。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw7_method.png" alt="hw7_method"></p>
<p><code>EleStrategy</code>即为先前的<code>Strategy</code>和<code>Strategies</code>类，复杂原因已经在前文中叙述过，在此不再叙述。</p>
<p><code>TestMain</code>是测试的一部分，不属于项目，也不会提交至评测平台。</p>
<p><code>ElevatorThread.run()</code>的主要复杂度来和第六次作业一样，源于结束条件的判断。不过相比第六次作业已经有了很大程度上的降低。</p>
<p><code>Elevator.outputString()</code>是一个用于输出的静态方法。对于单双轿厢电梯，双轿厢的上下层电梯都需要特判后才能进行输出，这导致设计的圈复杂度增加。</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/hw7_class.png" alt="hw7_class"></p>
<p><code>EleStrategy</code>的复杂度同第六次和第五次作业一致，不再过多叙述。</p>
<p><code>ElevatorThread</code>的复杂度是我没料到的，我坚持认为它不复杂。大概就是：认知复杂度高的方法<code>essential圈复杂度</code>都很低，</p>
<p><img lazyload="" src="/images/loading.svg" data-src="/images/OO/U2/ElevatorThreadComplexity.png" alt="ElevatorThreadComplexity"></p>
<h2 id="五、调度策略选择"><a href="#五、调度策略选择" class="headerlink" title="五、调度策略选择"></a>五、调度策略选择</h2><p>这一部分是关于具体的调度器调度策略，以及电梯的调度策略的叙述和我的选择。</p>
<p>经过第一单元的淬炼，我想第五次作业应该会有各种各样的神奇策略能够被想出来。但事实就是没人这么干。大多数人使用的都是<code>LOOK</code>策略。这里叙述几种常用的策略和我的选择：</p>
<h3 id="第五次作业-3"><a href="#第五次作业-3" class="headerlink" title="第五次作业"></a>第五次作业</h3><p>第五次作业调度器没有任何调度策略。调度仅发生在单个电梯中</p>
<h4 id="1-ALS调度策略"><a href="#1-ALS调度策略" class="headerlink" title="1. ALS调度策略"></a>1. ALS调度策略</h4><p>我至今也不知道<code>ALS</code>到底是什么的缩写，但是只要在互联网上搜索“ALS调度策略”，我们一定能找到北航计院的身影。</p>
<p><code>ALS</code>的调度策略很简单：</p>
<ol>
<li>电梯有人时，谁先到电梯就先送谁</li>
<li>电梯没人时，去接最早来的人</li>
<li>同向能捎带就捎带<br><code>ALS</code>的缺点很明显：</li>
<li>首先，尽管有主请求的定义，但是当电梯为空的时候，主请求很容易被捎带请求覆盖。因为只要一个空电梯捎带了一个人，那么被捎带的人就是主请求。所以这并不能避免等待时间长的人有更长的等待时间。</li>
<li>主请求容易诱导电梯，让电梯实际上并没有那么公正的策略，而是成为了一个谁手快谁占据更好的位置谁就更容易搭上电梯。</li>
<li>电梯的不公正的接客原则还使得电梯运行路程可能会更长，使得耗电更多。</li>
</ol>
<p><code>ALS</code>代表了一类算法，或者说一类算法的原则：优先接最早到达的人。这是ALS的整体原则，也是我们在设计时可以考虑的原则。</p>
<p>但是<code>ALS</code>并不是那么好。比如：</p>
<blockquote>
<p><strong>Example 1</strong>: 假如有一大波同学1楼到9楼，他们先按了电梯；而有另一波同学想从10楼到1楼，但是他们全部都按晚了电梯。</p>
</blockquote>
<p>根据<code>ALS</code>，他们的请求不会被响应，直到前一波人的请求全部被完成—。当电梯到9楼，电梯宁愿去接最早到的乘客，也就是1楼的乘客，也不愿意接10楼的乘客——哪怕电梯只需要上行一层楼！</p>
<p>事实上，不加改进的<code>ALS</code>策略的实(qiang)际(ce)表现也不佳。这就出现了<code>SCAN</code>策略和<code>LOOK</code>策略。</p>
<h4 id="2-SCAN-LOOK策略"><a href="#2-SCAN-LOOK策略" class="headerlink" title="2. SCAN/LOOK策略"></a>2. SCAN/LOOK策略</h4><p>回想一下我们现在乘坐的电梯，在<code>Example 1</code>中二楼的乘客每次上电梯的时候应该会发现有一大波人从电梯里涌出来。这是因为电梯采用了<code>LOOK</code>策略。在讲<code>LOOK</code>之前，先讲一下<code>SCAN</code>策略。</p>
<p><strong><code>SCAN</code>策略做的事就是在最高层和最底层之间来回扫</strong>。<code>SCAN</code>没有主请求，但是顺带着却能够接到更多人。在<code>Example 1</code>当中，他们会先去接10楼的乘客——不是因为10楼的乘客优先级有多高，只是因为电梯会运行到最高层（11层）再往下运行，而往下运行的时候就正好能够捎带10楼的乘客。</p>
<p>但是11楼是没有必要去的，因为11楼没有人。这就引出了<code>LOOK</code>策略。**<code>LOOK</code>策略意在解决<code>SCAN</code>中的无效运行<strong>。</strong>在<code>LOOK</code>中，我们只需要找到最高和最低的有需求的楼层就行了**：不需要到11楼，而是到10楼就行。</p>
<p>通过这个例子我还想说明一个问题，那就是<strong>只做大优化不做小优化</strong>。当你以为<code>LOOK</code>比<code>SCAN</code>好的时候，请思考这么一件事：如果在<code>LOOK</code>接到十楼的乘客并且开门了打算往下走，这时如果有一个十一楼的乘客刚刚按电梯，那这个十一楼的倒霉蛋就要在等一轮了。也就是说，无用的运行有可能会有用，这取决于具体输入。<strong>不要为一些小细节优化，总是要尝试进行大优化。</strong></p>
<p><code>LOOK</code>策略是一种非常好的策略。在第六次和第七次作业中，由于调度器会将乘客分配给不同电梯，很难出现一个电梯会有很多很多人的情况（数据限制最多100个乘客，平均下来每部电梯不超过17个乘客，很快就能送完）。所以<code>LOOK</code>的弊端再次看来并不会这么明显。</p>
<h4 id="3-LOOK-ALS"><a href="#3-LOOK-ALS" class="headerlink" title="3. LOOK + ALS"></a>3. LOOK + ALS</h4><p><code>LOOK</code>和<code>ALS</code>不仅仅是两个具体策略，他们更反映了两个思想方法或者原则：<strong>一个认为最早来的人最应该先响应，另一个认为我自己走我的路，方便我响应我就响应</strong>。<code>LOOK</code> 原则和 <code>ALS</code> 原则各有优劣：<code>LOOK</code>很容易使某一个人等待时间过长，而<code>ALS</code>可能会对某一些按按钮晚的人很不公平。</p>
<p>这两个原则可以结合一下，取长补短。比方说，<strong>我们可以优先响应同方向上到达时间最早的人，在保证能够接到它的前提下再去捎带其他人</strong>。这样子在一个方向上很难出现等待时间过长的人，进而会更好。</p>
<h4 id="4-我的算法"><a href="#4-我的算法" class="headerlink" title="4. 我的算法"></a>4. 我的算法</h4><p>我认为<code>LOOK + ALS</code>并不足以满足乘客的需求，因为这种算法只能考虑当前情况下等待时间最长的人，却不能考虑当前情况下多个等待时间很长的人。当一个方向上有很多等待时间很长的人的时候，而我们在没有接到他们之前接了其他捎带的人，那么这时候我们很可能就只能接到一个等待时间很长的人，也就是主请求。而其他人等待时间明明也很长，却因为在电梯接到他们之前捎带了其他人，因而无法搭乘电梯。</p>
<p><strong>坏心情算法认为造成这样的原因是因为主请求太少了。</strong> 如果有多个主请求，我们就可以先保证先去接这些主请求，再去考虑是否捎带。</p>
<p><strong>在我的算法中，请求的优先级是根据乘客的心情的好坏来决定的</strong>。我规定，<strong>如果电梯在一次捎带过程中明明可以和我同方向经过了我的楼层却不捎带我，那么我的坏心情就+1，也就是我的优先级在电梯眼中就提高了1级</strong>。<del>这种算法来源于使用新北电梯的真实感受，我把它叫做坏心情算法。</del></p>
<p>坏心情算法解救了<code>LOOK + ALS</code>算法中两个等待时间较长的人可能只能接到一个的问题，实际上如果稍微更改一下坏心情算法，将时间而不是坏心情作为最高优先级，我们就得到了另一种<code>LOOK + ALS</code>算法了。</p>
<p>坏心情算法的缺点也是很明显的：<strong>它几乎完全被坏心情的人带偏了</strong>。如果坏心情的人比较多，并且这些气急败坏的人的请求比较苛刻，那么它们可能会占据电梯的所有位置，导致捎带的人减少，进而导致电梯要花费更长的时间才能够送完所有乘客。</p>
<h4 id="5-LOOK的贪心改进"><a href="#5-LOOK的贪心改进" class="headerlink" title="5. LOOK的贪心改进"></a>5. LOOK的贪心改进</h4><p>方法提出自研讨课同学<code>N Boy</code>。膜！</p>
<p>传统<code>LOOK</code>认为只接同向可捎带的乘客。但是实际上在乘客较少的情况下，<code>LOOK</code>可以两个方向上的乘客都接上，以减少开关门时间。</p>
<h4 id="6-总结"><a href="#6-总结" class="headerlink" title="6. 总结"></a>6. 总结</h4><p>没有最好的调度策略，所有的调度策略都有反例，因为未来是未知的，人流量、目的、到达时间就无法纳入考虑因素当中。再退一步讲，即便我们能够知晓未来的一举一动，判断出最佳策略也是困难的。因此经过第五次作业后，我同意指导书的观点，最好的策略就是变换策略。<del>不过真的麻烦死了……</del></p>
<h3 id="第六次作业-3"><a href="#第六次作业-3" class="headerlink" title="第六次作业"></a>第六次作业</h3><p>在第六次作业中，乘客不再指定进入电梯号，而是由同(wan)学(jia)自行调配。因此在第六次作业中有两个策略需要完成：一个是把乘客分配到不同电梯的策略，另一个是电梯接送乘客的策略。由于电梯在没有RECEIVE的时候不能移动，<strong>因此不能让电梯自由竞争乘客</strong>。</p>
<p>第六次作业中的调度策略整体来说大概有这么几种构调度策略/原则：</p>
<h4 id="1-123456"><a href="#1-123456" class="headerlink" title="1. 123456"></a>1. 123456</h4><p>顾名思义，把乘客依次分配给1, 2, …6号电梯。性能十分均衡，性能分也很一般。</p>
<h4 id="2-随机调度原则"><a href="#2-随机调度原则" class="headerlink" title="2. 随机调度原则"></a>2. 随机调度原则</h4><p>随机将乘客分配到不同的电梯。实测随机调度大概能够在强测中获得 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="4.651ex" height="1.819ex" role="img" focusable="false" viewBox="0 -666 2055.8 804"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mn" transform="translate(1055.8,0)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(500,0)"></path></g></g></g></svg></mjx-container> 的优秀性能分。再在基础上做一些小优化就可以拿到很不错的分数了。</p>
<p>调度的随机性意味着得分的随机性，不清楚课程组会不会反复测试代码然后取平均，但是本地运行多次可能会有不同的效果。乘客量和乘客密度大的时候几乎不会有分数波动。</p>
<h4 id="3-捎带原则"><a href="#3-捎带原则" class="headerlink" title="3. 捎带原则"></a>3. 捎带原则</h4><p>方便捎带就能捎带，结合<code>LOOK</code>类算法可以有不错的性能。不适用于坏心情这一类复杂的算法，理由是很难计算能不能捎带这个人。</p>
<h4 id="4-影子电梯"><a href="#4-影子电梯" class="headerlink" title="4. 影子电梯"></a>4. 影子电梯</h4><p>实际上，根据现有的所有信息，我们是能计算出乘客应该分配到哪一个电梯最好的。我们只需要模拟一遍电梯的运行，算出把乘客分配到哪个电梯更好，然后分配给电梯就行。而且这个分配的时间是由调度器完成的，意味着分配不会占用电梯运行时间。这是最理想的贪心算法。由于模拟过程好似有一个和实际电梯完全一样的电梯在运行，所以称模拟的电梯为影子电梯。</p>
<p>影子电梯的模拟也是分好坏的。优秀的影子电梯可以做到强测 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.312ex;" xmlns="http://www.w3.org/2000/svg" width="4.651ex" height="1.819ex" role="img" focusable="false" viewBox="0 -666 2055.8 804"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mn" transform="translate(1055.8,0)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" transform="translate(500,0)"></path></g></g></g></svg></mjx-container> 分。</p>
<p>影子电梯也有模拟不到的地方，比如很难将<code>RESET</code>用时考虑进影子电梯中。</p>
<p>单电梯的调度策略和上次一样，<code>LOOK</code>就行。</p>
<h3 id="第七次作业-3"><a href="#第七次作业-3" class="headerlink" title="第七次作业"></a>第七次作业</h3><p>几乎没有变化，本人第七次作业摆大烂。至于调度策略，基本上同第六次和第五次作业。</p>
<h2 id="六、Bug-Debug"><a href="#六、Bug-Debug" class="headerlink" title="六、Bug & Debug"></a>六、Bug &amp; Debug</h2><h3 id="遇到的Bug"><a href="#遇到的Bug" class="headerlink" title="遇到的Bug"></a>遇到的Bug</h3><h4 id="1-电梯的等待队列waitQueue不是线程安全的"><a href="#1-电梯的等待队列waitQueue不是线程安全的" class="headerlink" title="1. 电梯的等待队列waitQueue不是线程安全的"></a>1. 电梯的等待队列waitQueue不是线程安全的</h4><p>解决方案：使用同步方法。</p>
<h4 id="2-电梯为空时无法决定新的方向"><a href="#2-电梯为空时无法决定新的方向" class="headerlink" title="2. 电梯为空时无法决定新的方向"></a>2. 电梯为空时无法决定新的方向</h4><p>解决方案：那就根据<code>LOOK</code>策略选择一个方向。</p>
<h4 id="3-同步方法过多"><a href="#3-同步方法过多" class="headerlink" title="3. 同步方法过多"></a>3. 同步方法过多</h4><p>解决方案：分析线程的关系，只在容易产生冲突的地方进行同步；私有化方法</p>
<h4 id="4-git-commit-–amend使用不熟练"><a href="#4-git-commit-–amend使用不熟练" class="headerlink" title="4. git commit –amend使用不熟练"></a>4. git commit –amend使用不熟练</h4><p>解决方案：自己手动解决冲突就行，应该相当于commit一次再与上一次提交merge。</p>
<h4 id="5-疑似非法提交"><a href="#5-疑似非法提交" class="headerlink" title="5. 疑似非法提交"></a>5. 疑似非法提交</h4><p>我为不同类写了一个debug()方法，但是问题是难以判断调试信息输出的位置。搜索后发现下面这行代码可以打印当前Thread运行位置。评测中检测非法字符串的时候检测到了这一行代码。</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(Thread.currentThread().getStackTrace(](<span class="number">1</span>].getMethodName())</span><br></pre></td></tr></table></figure></div>

<h4 id="6-RESET和RECEIVE冲突"><a href="#6-RESET和RECEIVE冲突" class="headerlink" title="6. RESET和RECEIVE冲突"></a>6. RESET和RECEIVE冲突</h4><p>这在第六次作业和第七次作业中比较常见。<code>RECEIVE</code>不能再电梯的<code>RESET</code>期间输出，否则错误。第六次作业误打误撞把冲突解决了，导致第七次作业出现这个报错的时候我都不知道原来还有这项要求。</p>
<p>解决方案：加一把锁，<code>RESET</code>期间持有锁，完成<code>RESET</code>后释放。简单来说就是电梯必须在外界看来永远都是在正常运行的。如果在不正常期间运行的话，外界对电梯的访问就会被阻塞住。</p>
<p>注意事项：另一种解决方案是通过查看电梯的运行状态来判断要不要等待，如果电梯在<code>RESET</code>状态就等待，直到被<code>notify()</code>。这样的实现是不稳妥的，很有可能在你查看状态的下一瞬间电梯就完成<code>RESET</code>并且<code>notify()</code>，这样子就查看电梯状态的线程就永远不可能醒过来了。<strong>如果一个线程的运行依赖另一个线程的状态，那么最好用锁。</strong></p>
<h4 id="7-未RESET-BEGIN就重新分配等待队列中的乘客"><a href="#7-未RESET-BEGIN就重新分配等待队列中的乘客" class="headerlink" title="7. 未RESET_BEGIN就重新分配等待队列中的乘客"></a>7. 未RESET_BEGIN就重新分配等待队列中的乘客</h4><p><strong>在<code>RESET_BEGIN</code>之前电梯需要把分配到这部电梯的乘客交给调度器，调度器会调度乘客，乘客会被分给新的电梯并输出<code>RECEIVE</code><strong>。这看起来没什么问题，但是这一切都可能在一瞬间完成，然后下一瞬间电梯才输出<code>RESET_BEGIN</code>！</strong>意味着电梯还没有<code>RESET_BEGIN</code>时，另一个电梯就抢走了原本电梯的乘客！</strong> 第六次和第七次作业不允许出现这样的行为。</p>
<p>解决方案：我的解决方案比较奇葩。我会先让乘客从电梯轿厢中假装出来（输出开关门和出电梯但时在对象的数据中仍然存在于电梯轿厢中），然后输出<code>RESET_BEGIN</code>，再把乘客送给调度器。</p>
<h4 id="8-多产品的生产消费模型"><a href="#8-多产品的生产消费模型" class="headerlink" title="8. 多产品的生产消费模型"></a>8. 多产品的生产消费模型</h4><p>电梯的重置<code>RESET</code>有至少两种实现方式：一种是将<code>RESET</code>作为一种属性写入电梯中，电梯每次切换状态需要查看是否处于需要<code>RESET</code>的状态，需要则<code>RESET</code>。但是如果有多个<code>RESET</code>指令同时涌进来的话，前一条<code>RESET</code>指令就会被覆盖掉，不过由于第六次和第七次作业的约束（同一电梯的两条<code>RESET</code>不能有太近的时间间隔），这种情况几乎不可能发生。</p>
<p>另一种实现方式是将<code>RESET</code>看成另一种产品传递给电梯，构建区别于乘客这种产品的另一条生产-消费供应链。这就产生了多产品的生产消费模型。这给控制设计带来了不少的麻烦（自己写一遍就知道问题了）。</p>
<p>解决方案：让多产品的输入共用一把锁，使用<code>Check-and-Act</code>行为进行设计。</p>
<h4 id="9-停不下来"><a href="#9-停不下来" class="headerlink" title="9. 停不下来"></a>9. 停不下来</h4><p>解决方案：具体停不下来的原因千奇百怪，设置合适的终止条件基本就能停下来了</p>
<h3 id="Debug策略"><a href="#Debug策略" class="headerlink" title="Debug策略"></a>Debug策略</h3><p>多线程<code>Debug</code>是一件麻烦事，不过<code>IDEA</code>帮我们做了不少工作。<code>IDEA</code>中右键断点的红点点可以选择默认多线程<code>Debug</code>，因而在每一个线程运行到这一行代码的时候都能够停下来（不过我倒是很好奇<code>gdb</code>有没有这种功能）。缺点就是实际上运行时不会有线程停下来，所以导致运行和调试可能带来不同。即便如此，<code>Debug</code>还是麻烦的：<code>Debug</code>效率本来就低，现在还要同时在六个电梯线程中打断点，这我真的受不了一点。<strong>所以我直接<code>print</code>大法调试</strong>。我在每一个我需要用到的类里面写了一个<code>debug()</code>方法，用于往终端输出该对象的信息。另外建议将<code>printf</code>大法打印出来的信息直接输出到标准错误输出，因为<code>IDEA</code>中标准错误输出是红色的。</p>
<p><strong>在第六次和第七次作业中我写了一个<code>Debug</code>类（里面全是静态方法），所有的printf函数都是调用Debug类的静态方法完成的</strong>。并且在<code>Debug</code>类中设置了一个参数<code>valid</code>，输出当且仅当<code>valie = true</code>，否则不会输出debug调试信息。</p>
<h2 id="七、心得体会"><a href="#七、心得体会" class="headerlink" title="七、心得体会"></a>七、心得体会</h2><p>首先印象最深的是关于<code>synchronized</code>关键字。<code>synchronized</code>的同步语句块或者同步方法只需要在共享对象上使用，或者更一般地，只需要在多个线程产生访存冲突的地方使用。合适的<code>synchronized</code>可以更好地保证程序的正确性和安全性。在第五次作业中，由于滥用<code>synchronized</code>关键字，我得到了非常糟糕的第五次作业初稿。</p>
<p>此外，这次作业也算是掌握了一些基本的多线程编程的基本思想。生产-消费模型是多线程或者并行编程中的一个最基本的模型，电梯分配属于他们的一个简化版本：没有产品上限，不需要考虑生产消费速度，也几乎不需要考虑某一个电梯闲置时间过长的情况（顶多强测分数低一点）。此外，<code>JAVA</code>提供了非常舒适的多线程编程方法，在其他并行编程模型中不一定会有这么舒适的选项。</p>
<p>最重要的，应该是对多线程有了更深的理解吧。个人感觉这种多线程编程、并行编程的编程方法，在日后的编程学习中应当会有非常好的应用，而且不一定会有机会再接触到了。</p>
<h2 id="八、课程建议"><a href="#八、课程建议" class="headerlink" title="八、课程建议"></a>八、课程建议</h2><p>不知道第三单元和第四单元学些什么，但是第二单元多线程确实蛮有用的，如果后两单元没啥大事的话个人认为其实可以把这一单元延长一点…点。</p>
<p>（好像还是说了很多废话…）</p>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 「BUAA OO」Unit-2 电梯调度</li>
        <li><strong>作者:</strong> Squirrel7ang</li>
        <li><strong>创建于
                :</strong> 2024-03-31 18:55:00</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-04-19 15:30:05
            </li>
        
        <li>
            <strong>链接:</strong> https://redefine.ohevan.com/2024/03/31/OO/Unit-2/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/OO/">#OO</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2024/05/16/OO/Unit-3/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">「BUAA OO」Unit-3 JML月</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/03/13/OO/Unit-1/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">「BUAA OO」Unit-1 表达式计算</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://example.example.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          recaptchaV3Key: "wasd",
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">「BUAA OO」Unit-2 电梯调度</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%B5%E6%A2%AF"><span class="nav-text">电梯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="nav-text">一、前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%A2%98%E7%9B%AE%E8%83%8C%E6%99%AF"><span class="nav-text">二、题目背景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A"><span class="nav-text">第五次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A"><span class="nav-text">第六次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A"><span class="nav-text">第七次作业</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="nav-text">三、解题思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A-1"><span class="nav-text">第五次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A-1"><span class="nav-text">第六次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A-1"><span class="nav-text">第七次作业</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%92%8C%E5%88%86%E6%9E%90"><span class="nav-text">四、架构设计和分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A-2"><span class="nav-text">第五次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A-2"><span class="nav-text">第六次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A-2"><span class="nav-text">第七次作业</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5%E9%80%89%E6%8B%A9"><span class="nav-text">五、调度策略选择</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%AC%A1%E4%BD%9C%E4%B8%9A-3"><span class="nav-text">第五次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%AC%A1%E4%BD%9C%E4%B8%9A-3"><span class="nav-text">第六次作业</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E6%AC%A1%E4%BD%9C%E4%B8%9A-3"><span class="nav-text">第七次作业</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81Bug-Debug"><span class="nav-text">六、Bug &amp; Debug</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%81%87%E5%88%B0%E7%9A%84Bug"><span class="nav-text">遇到的Bug</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Debug%E7%AD%96%E7%95%A5"><span class="nav-text">Debug策略</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E5%BF%83%E5%BE%97%E4%BD%93%E4%BC%9A"><span class="nav-text">七、心得体会</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E8%AF%BE%E7%A8%8B%E5%BB%BA%E8%AE%AE"><span class="nav-text">八、课程建议</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Squirrel7ang</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.0</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
